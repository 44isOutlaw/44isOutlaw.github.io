<!DOCTYPE html><html lang="ko" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Lstm을 이용한 데이터 분석" /><meta property="og:locale" content="ko" /><meta name="description" content="RNN을 이용한 시계열 데이터 분석" /><meta property="og:description" content="RNN을 이용한 시계열 데이터 분석" /><link rel="canonical" href="https://44isoutlaw.github.io/posts/LSTM%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D/" /><meta property="og:url" content="https://44isoutlaw.github.io/posts/LSTM%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D/" /><meta property="og:site_name" content="Toolbox 44" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-08T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Lstm을 이용한 데이터 분석" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-08T00:00:00+09:00","datePublished":"2022-08-08T00:00:00+09:00","description":"RNN을 이용한 시계열 데이터 분석","headline":"Lstm을 이용한 데이터 분석","mainEntityOfPage":{"@type":"WebPage","@id":"https://44isoutlaw.github.io/posts/LSTM%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D/"},"url":"https://44isoutlaw.github.io/posts/LSTM%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D/"}</script><title>Lstm을 이용한 데이터 분석 | Toolbox 44</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Toolbox 44"><meta name="application-name" content="Toolbox 44"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Toolbox 44</a></div><div class="site-subtitle font-italic">학교와 연구실에서 배운 지식들을 나중에 기록하는 용도입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/44isOutlaw" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wpsltm9204','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Lstm을 이용한 데이터 분석</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Lstm을 이용한 데이터 분석</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1659884400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 8, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">your_full_name</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2864 words"> <em>15 min</em> read</span></div></div></div><div class="post-content"><h1 id="rnn을-이용한-시계열-데이터-분석">RNN을 이용한 시계열 데이터 분석</h1><h2 id="ⅰ-intro"><span class="mr-2">Ⅰ. Intro</span><a href="#ⅰ-intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Machine learning을 이용하여 시간축이 있는 데이터를 학습하기 위해서는 어느 데이터의 이전 시간, 그리고 다음 시간의 정보가 반영되어야만 한다. 하지만 기존의 NN은 한 샘플의 전후 데이터가 반영되지 않는 바, 이러한 시계열 데이터를 다루기 위한 새로운 model이 고안되었으니 이것이 Recurrent Neural Network(이하 RNN)이다. 이하 본문에서는 RNN 및 RNN에 속하는 유용한 model을 이용하여 시계열 데이터 분석 과정을 소개한다.</p><h2 id="ⅱ-recurrent-nerual-network"><span class="mr-2">Ⅱ. Recurrent Nerual Network</span><a href="#ⅱ-recurrent-nerual-network" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>(이하 내용은 “딥 러닝을 이용한 자연어 처리 입문” https://wikidocs.net/2288 을 기반으로 스스로 이해한 바를 작성하였습니다.)</p><p><img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/rnn_image1_ver2.PNG?raw=true" alt="1" data-proofer-ignore></p><p>RNN의 특징을 우선 설명하면, 위 그림과 같이 셀(cell)이 있다는 점이다. 셀은 이전의 값을 기억하려고 하고, 이를 다음 셀로 전달한다. 즉 이전 시간의 정보를 다음 시간의 정보 학습에 반영시킬 수 있다는 것이다.</p><p><img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/rnn_image4_ver2.PNG?raw=true" alt="2" data-proofer-ignore> <img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/rnn_image2_ver3.PNG?raw=true" alt="3" data-proofer-ignore></p><p>좌측 그림과 같이 현재의 셀은 이전 시간 셀로부터 h라는 값을 받으며, 이를 은닉 상태(hidden state)라고 표현한다. 전달받은 과거의 은닉 상태(h<sub>t-1</sub>)는 현재의 은닉 상태(h<sub>t</sub>)를 계산하는데 사용된다. 계산 과정은 NN와 같이 가중치(w) 및 bias(b)가 추가되어 activation function을 거치는 과정을 거친다. 이렇게 얻은 현재의 h는 출력값 y를 계산하는데 사용된다. 이와 같은 특징을 살려 시계열 데이터의 학습이 가능해지며, 데이터의 분석 뿐만 아니라 다음 시간의 출력값 예측(예를 들어, 주가 동향) 등 다양한 상황에 적용할 수 있다.</p><p><img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/lstm_image1_ver2.PNG?raw=true" alt="4" data-proofer-ignore></p><p>하지만 위와 같은 방식의 RNN에는 단점이 있는데, 많은 시간 간격을 지날수록 초기의 은닉 상태값의 특징이 옅어진다는 점이다. 이는 곧 시간이 길어질수록 초반부의 데이터가 반영되지 않음을 의미하며 의도한 바와 다르게 model의 학습되는 결과를 야기한다. 이를 장기 의존성 문제(the problem of Long-Term Dependencies)라고 한다. 이를 해결하기 위해, RNN을 수정한 모델인 LSTM, GRU 등이 등장하게 된다.</p><h2 id="ⅲ-lstm-gru"><span class="mr-2">Ⅲ. LSTM, GRU</span><a href="#ⅲ-lstm-gru" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>시계열 데이터를 다루는 가장 대표적인 두 모델인 LSTM, GRU에 대하여 알아보자.</p><p><img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/vaniila_rnn_and_different_lstm_ver2.PNG?raw=true" alt="5" data-proofer-ignore></p><p>위 그림은 Long Short-Term Memory(이하 LSTM)의 구조이다. LSTM은 기존 은닉 상태(h)와 새롭게 추가된 셀 상태(C)를 삭제 게이트, 입력 게이트, 출력 게이트를 통해 계산하여 불필요한 정보를 제거하고 기억해야 할 정보를 다음 상태로 전달시키는 과정을 수행한다. 현재의 셀 상태(C<sub>t</sub>)는 삭제 게이트를 거쳐온 이전 셀 상태(C<sub>t-1</sub>)와 입력 게이트를 거쳐온 이전 은닉 상태(h<sub>t-1</sub>)와 현재 입력값(x <sub>t</sub> )을 통해 계산되며, 현재의 은닉 상태(h<sub>t</sub>)는 이전 은닉 상태(h<sub>t-1</sub>)와 현재 입력값(x<sub>t</sub>)를 통해 계산되며, 최종 output에 도달할 때까지 반복된다. LSTM은 이와 같이 게이트들이 정보를 선별하면서 장기 의존성 문제를 완화하여, 초기 시간의 중요 정보들을 보존하여 학습을 수행할 수 있다.</p><p>​ <img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/gru.PNG?raw=true" alt="6" data-proofer-ignore></p><p>한편, Gated Recurrent Unit(이하 GRU)의 구조는 위 그림과 같다. GRU는 LSTM과 달리 업데이트 게이트와 리셋 게이트를 갖고 있다. 두 게이트 모두 이전 은닉 상태(h<sub>t-1</sub>)와 현재 입력값(x <sub>t</sub> )이 지나가게 되는데, 업데이트 게이트를 지난 값(z<sub>t</sub>)이 이전 은닉 상태(h<sub>t-1</sub>)와 리셋 게이트와 현재 입력값(x <sub>t</sub> )을 거쳐 연산된 g<sub>t</sub>의 비중을 조절하여 현재 은닉 상태(h<sub>t</sub>)를 출력한다. 이와 같은 방식으로 이전의 중요 정보들을 보전하여 장기 의존성 문제를 완화한다. GRU는 LSTM과 비슷한 성능을 갖고 있으므로, LSTM의 최적화를 마쳤다면 굳이 GRU로 바꿀 필요가 없다고 한다.</p><h2 id="ⅳ-keras의-lstm을-이용한-시계열-데이터-분석"><span class="mr-2">Ⅳ. Keras의 LSTM을 이용한 시계열 데이터 분석</span><a href="#ⅳ-keras의-lstm을-이용한-시계열-데이터-분석" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이번 model의 목표는 position, velocity를 입력 받으면 energy 소모량을 예측할 수 있도록 하는 것이다. 이하에는 그 과정을 기록한다.</p><h3 id="시계열-데이터의-처리"><span class="mr-2">시계열 데이터의 처리</span><a href="#시계열-데이터의-처리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="table-wrapper"><table><thead><tr><th>time<th>position<th>velocity<th>energy<tbody><tr><td>0<td>0<td>0<td>0<tr><td>1<td>15<td>100<td>1000<tr><td>2<td>67<td>360<td>3000<tr><td>…<td>…<td>…<td>…</table></div><p>오늘 사용하는 데이터는 공개하기에는 어려움이 있어, 예시로만 설명을 하고자 한다. 이 데이터는 시간에 따라 어떤 기계의 위치, 속도의 변화에 따른 에너지 소모량을 기록한 것이다. 이와 같이 일정 시간 간격마다 기록된 데이터를 <strong>시계열 데이터</strong>라고 한다. 이번엔 이렇게 생긴 엑셀 파일(.xlsx)을 구글 드라이브에서 import 받을 것이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>
</pre></table></code></div></div><p>위와 같은 코드를 통해 구글 드라이브에 접근할 수 있다. 이 코드를 작성하면 보안 알림이 뜨는데 모두 예를 누르면 된다. 이렇게 입력하고 colab의 좌측 파일 모양의 아이콘을 누르면,</p><p><img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/data1.PNG?raw=true" alt="data1" data-proofer-ignore></p><p>이와 같이 drive가 추가된 것을 볼 수 있다. 여기서는 내부 파일에 있는 MyDrive에 xlsx 파일을 업로드하여 import 하였으며, 사용된 코드는 아래와 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"/content/drive/MyDrive/data.xlsx"</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s">'openpyxl'</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s">'Sheet1'</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"/content/drive/MyDrive/data.xlsx"</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s">'openpyxl'</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s">'Sheet2'</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"/content/drive/MyDrive/data.xlsx"</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s">'openpyxl'</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s">'Sheet3'</span><span class="p">)</span>
</pre></table></code></div></div><p>pd.read_excel을 통해 xlsx 파일을 pandas의 dataframe으로 받을 수 있다. 엑셀 파일이 여러 개의 sheet로 나뉘어 있다면 sheet_name을 인자로 하나씩 저장할 수 있다. 위 파일은 3개의 sheet가 있으며, data라는 이름의 list를 정의하여 하나씩 저장하였다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][[</span><span class="s">'position'</span><span class="p">,</span> <span class="s">'velocity'</span><span class="p">]].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][[</span><span class="s">'position'</span><span class="p">,</span> <span class="s">'velocity'</span><span class="p">]].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][[</span><span class="s">'position'</span><span class="p">,</span> <span class="s">'velocity'</span><span class="p">]].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][[</span><span class="s">'energy'</span><span class="p">]].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][[</span><span class="s">'energy'</span><span class="p">]].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][[</span><span class="s">'energy'</span><span class="p">]].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="n">y1</span><span class="p">[</span><span class="n">y1</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y2</span><span class="p">[</span><span class="n">y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y3</span><span class="p">[</span><span class="n">y3</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></table></code></div></div><p>그 다음, 이 data에서 input과 output을 나누어 보았다. <strong>이번 model의 목표는 position, velocity를 이용하여 energy를 예측하는 것</strong>이므로 input이 position과 velocity를, output이 energy라고 볼 수 있다. 위와 같이 x, y를 정의하여 형식을 dataframe에서 numpy의 array로 바꿔 keras model이 사용할 수 있도록 하였다. 한편, 데이터에 포함된 N/A를 0으로 바꾸는 fillna(0)와 에너지가 0 이하인것은 불가능하므로 모두 0으로 변경하는 코드를 추가하여 데이터를 손질하였다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">x_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">y_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">x_scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">x_scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x2</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x2</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">x_scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x3</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x3</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x3</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">y_scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">y1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">y_scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y2</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">y2</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y2</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">y_scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y3</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">y3</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y3</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></table></code></div></div><p>이후, 데이터 표준화 작업을 해줬다. StandardScaler는 어떤 인자도 넣지 않으면 평균 0, 분산이 1인 정규분포로 데이터를 재단해준다. 다만, reshape를 사용하는 이유가 있는데..</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">x1</span> <span class="o">=</span> <span class="n">x_scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x1</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(2171,2) # (time step, feature)
</pre></table></code></div></div><p>Scaler는 2차원만을 받아 표준화한다. 당연히 그 결과물도 2차원인데, 오늘 사용할 <strong>LSTM은 3차원의 데이터를 받는다</strong>는 점이 문제가 된다. 따라서,</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">x1</span> <span class="o">=</span> <span class="n">x_scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">x1</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(1, 2171, 2) # (size, time step, feature)
</pre></table></code></div></div><p>이렇게 reshape를 반드시 해주어야 한다. 쉽게 이해하자면,</p><ul><li><p>Size : 샘플(시간 스텝이 없는 데이터를 생각해보자)</p><li><p>Time step : 샘플이 가지고 있는 시간 간격</p><li><p>Feature : Input 또는 Output</p></ul><p>과 같이 이해할 수 있다.</p><h3 id="lstm-모델-정의-및-학습"><span class="mr-2">LSTM 모델 정의 및 학습</span><a href="#lstm-모델-정의-및-학습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">optimizers</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">ReduceLROnPlateau</span> <span class="p">,</span> <span class="n">EarlyStopping</span>
<span class="c1">#이렇게 import하면 더 짧게 Sequential 등을 사용할 수 있다.
</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span><span class="n">LSTM</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">return_sequences</span> <span class="o">=</span> <span class="bp">True</span><span class="p">),</span>
                    <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">loss</span><span class="o">=</span><span class="s">'MSE'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'MSE'</span><span class="p">])</span>
<span class="n">reduceLR</span> <span class="o">=</span> <span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span> <span class="o">=</span> <span class="s">'val_MSE'</span><span class="p">,</span> <span class="n">patience</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="n">ES</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span> <span class="o">=</span> <span class="s">'val_MSE'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'min'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patience</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p>우선 LSTM의 중요 인자를 살펴보면,</p><ul><li><p>units : 차원 수, node 수와 비슷한 개념으로 통용되는 듯 하다.</p><li><p>return_sequences : False가 default값으로, False로 설정하면 마지막 Time step의 결과만 출력하고 True로 설정한다면 Time step마다 결과물을 출력한다.</p><li><p>initializer, activation : kernel_initializer, recurrent_initializer, activation, recurrent_activation 등 다양한 인자가 존재하는데, 각각 default값이 LSTM의 정의에 맞게 설정되어 있으므로 따로 입력하지 않아도 된다.</p><li><p>dropout : LSTM은 인자로 dropout을 설정할 수 있는데, 이를 통해 정의하면 이전 시간을 반영하는 LSTM의 특성상 dropout 설정으로 생길 수 있는 문제를 어느정도 완화할 수 있다고 한다.</p></ul><p>이번 model의 목적에 부합하려면 time step에서 에너지가 어느정도인지 계산해내야 한다. 따라서 return_sequences를 True로 설정하였다.</p><p>또, compile에서 loss를 MAE(Mean Absolute Error)로 설정하였다. 이는 MSE와 비교할 때 제곱하지 않는다는 점에서 outlier(전반적인 흐름에 어긋나는 데이터들을 의미한다. 보통 학습을 방해하지만 실제 내가 사용한 데이터에서는 어쩔 수 없이 포함시켜야 했다.)의 영향력이 줄어든다는 점에서 loss 함수로 채택하였다. 한편 Metrics에 MSE를 포함시켜 learning rate 감소 및 earlystopping을 설정하였다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">reduceLR</span><span class="p">,</span> <span class="n">ES</span><span class="p">],</span> <span class="n">validation_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</pre></table></code></div></div><p>(x1, y1)을 train data로, (x2, y2)를 validation data로, (x3, y3)을 test data로 사용하여 학습을 완료했다.</p><h3 id="결과-확인"><span class="mr-2">결과 확인</span><a href="#결과-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="p">)</span> <span class="c1">#loss(MAE), MSE값을 볼 수 있다.
</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_pred</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y_pred</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_scaler</span><span class="p">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y3</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y_test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_scaler</span><span class="p">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></table></code></div></div><p>아까 scaler는 2차원의 data만 취급한다는 점을 강조하였는데, 이는 표준화를 풀 때에도 마찬가지이므로 데이터를 2차원으로 reshape해줘야 한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span> <span class="c1">#graph의 사이즈
</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span> <span class="c1">#graph의 위치, 3x1 중 첫번째라는 뜻
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'W'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'energy'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span>
</pre></table></code></div></div><p><img data-src="https://github.com/44isOutlaw/44isOutlaw.github.io/blob/master/assets/img/RNN/data3.png?raw=true" alt="data2" data-proofer-ignore></p><p>이렇게 해서 LSTM을 이용한 시계열 데이터를 분석 및 예측하는 model을 만들어 보았다. 다음 post에서는 이를 발전시킬 다양한 방법들에 대해 작성하도록 하겠다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Lstm%EC%9D%84+%EC%9D%B4%EC%9A%A9%ED%95%9C+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EB%B6%84%EC%84%9D+-+Toolbox+44&url=https%3A%2F%2F44isoutlaw.github.io%2Fposts%2FLSTM%25EC%259D%2584-%25EC%259D%25B4%25EC%259A%25A9%25ED%2595%259C-%25EB%258D%25B0%25EC%259D%25B4%25ED%2584%25B0-%25EB%25B6%2584%25EC%2584%259D%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Lstm%EC%9D%84+%EC%9D%B4%EC%9A%A9%ED%95%9C+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EB%B6%84%EC%84%9D+-+Toolbox+44&u=https%3A%2F%2F44isoutlaw.github.io%2Fposts%2FLSTM%25EC%259D%2584-%25EC%259D%25B4%25EC%259A%25A9%25ED%2595%259C-%25EB%258D%25B0%25EC%259D%25B4%25ED%2584%25B0-%25EB%25B6%2584%25EC%2584%259D%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2F44isoutlaw.github.io%2Fposts%2FLSTM%25EC%259D%2584-%25EC%259D%25B4%25EC%259A%25A9%25ED%2595%259C-%25EB%258D%25B0%25EC%259D%25B4%25ED%2584%25B0-%25EB%25B6%2584%25EC%2584%259D%2F&text=Lstm%EC%9D%84+%EC%9D%B4%EC%9A%A9%ED%95%9C+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EB%B6%84%EC%84%9D+-+Toolbox+44" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/DNN%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EB%A5%98/"><div class="card-body"> <em class="small" data-ts="1658674800" data-df="ll" > Jul 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dnn을 이용한 데이터 분류</h3><div class="text-muted small"><p> DNN을 이용한 데이터 분류 Ⅰ. Intro Machine learning 기법 중 하나인 NN(Neural Network)에 대하여 간단히 알아보고, 이를 구현한 keras 모델을 이용해 데이터를 분류하는 과정을 본문에 정리했다. Ⅱ. Neural Network Neural Network(이하 NN)은 Machine learning 기법 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/DNN%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EB%A5%98/" class="btn btn-outline-primary" prompt="Older"><p>Dnn을 이용한 데이터 분류</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
